---
import GithubContributions from "../components/githubContributions";
import NavbarWrapper from "../components/NavbarWrapper.astro";
import Projectcard from "../components/projectcard.astro";
import projects from "../data/projects.json";
import aimlprojects from "../data/aimlprojects.json";
import SubLayout from "../layouts/SubLayout.astro";
import '../styles/global.css';

const GH_TOKEN = import.meta.env.GH_TOKEN as string;
const GH_USERNAME = import.meta.env.GH_USERNAME as string;
---
<SubLayout title="Nikshaan | Portfolio - Projects" description="Projects made by Nikshaan on web development, machine learning and deep learning.">
<script is:inline define:vars={{ GH_TOKEN, GH_USERNAME }}>
  window.__GH_TOKEN__ = GH_TOKEN;
  window.__GH_USERNAME__ = GH_USERNAME;
</script>
<section class="lg:w-[65rem] m-auto flex-1 text-white">
        <div class="w-full px-4 lg:px-2">
          <GithubContributions client:load />
        </div>
        <div class="flex py-16 flex-col mt-5 pl-4 ml-1 lg:mt-0 lg:ml-3 lg:px-2 justify-start items-start">
          <div class="flex justify-between items-center w-full">
            <p class="text-xl font-medium">PROJECTS</p>
              <div class="flex gap-3" role="group" aria-label="Project category filter">
                <button 
                  id="aimlBtn" 
                  class="project-filter-btn bg-white border-black text-black p-1 text-sm hover:bg-gray-300 transition-colors active cursor-pointer"
                  aria-label="Show AI/ML projects"
                  aria-pressed="true"
                  data-category="aiml"
                >
                  AI/ML
                </button>
                <button 
                  id="webDevBtn" 
                  class="project-filter-btn p-1 text-sm cursor-pointer hover:bg-gray-300 transition-colors"
                  aria-label="Show web development projects"
                  data-category="web"
                >
                  Web development
                </button>
              </div>
          </div>
          <div id="webProjectsContainer" class="px-4 border-l" style="display: none;">
              {
                projects.web_projects.map((project) => (
                  <Projectcard name={project.name} techstack={project.techstack} summary={project.summary} github={project.github} live={project.live} />
                ))
              }
          </div>
          <div id="aimlProjectsContainer" class="px-4 border-l">
              {
                aimlprojects.aiml_projects.map((project: any) => (
                  <Projectcard name={project.name} techstack={project.techstack} summary={project.summary} github={project.github} live={project.live} />
                ))
              }
          </div>
        </div>
    </section>
    
    <script>
      const webDevBtn = document.getElementById('webDevBtn') as HTMLButtonElement;
      const aimlBtn = document.getElementById('aimlBtn') as HTMLButtonElement;
      const webProjectsContainer = document.getElementById('webProjectsContainer') as HTMLDivElement;
      const aimlProjectsContainer = document.getElementById('aimlProjectsContainer') as HTMLDivElement;

      function switchCategory(category: 'web' | 'aiml'){
        if(category === 'web'){
          webDevBtn?.classList.remove('border-white');
          webDevBtn?.classList.add('bg-white', 'border-black', 'text-black', 'active');
          webDevBtn?.setAttribute('aria-pressed', 'true');
          aimlBtn?.classList.remove('bg-white', 'border-black', 'text-black', 'active');
          aimlBtn?.classList.add('border-white');
          aimlBtn?.setAttribute('aria-pressed', 'false');
          webProjectsContainer.style.display = 'block';
          aimlProjectsContainer.style.display = 'none';
        } else{
          aimlBtn?.classList.remove('border-white');
          aimlBtn?.classList.add('bg-white', 'border-black', 'text-black', 'active');
          aimlBtn?.setAttribute('aria-pressed', 'true');
          webDevBtn?.classList.remove('bg-white', 'border-black', 'text-black', 'active');
          webDevBtn?.classList.add('border-white');
          webDevBtn?.setAttribute('aria-pressed', 'false');
          webProjectsContainer.style.display = 'none';
          aimlProjectsContainer.style.display = 'block';
        }
      }

      webDevBtn?.addEventListener('click', () => {
        if(!webDevBtn.classList.contains('active')){
          switchCategory('web');
        }
      });
      
      aimlBtn?.addEventListener('click', () => {
        if(!aimlBtn.classList.contains('active')){
          switchCategory('aiml');
        }
      });
    </script>
</SubLayout>

<style>
  [data-theme="light"] .project-filter-btn {
    color: #000000;
  }
  
  [data-theme="light"] .project-filter-btn.bg-white {
    background-color: #3b82f6 !important;
    color: #ffffff !important;
  }
  
  [data-theme="light"] .project-filter-btn.border-white {
    border-color: #000000 !important;
  }
  
  [data-theme="light"] .project-filter-btn.border-black {
    border-color: #3b82f6 !important;
  }
  
  [data-theme="light"] .project-filter-btn:hover {
    background-color: rgba(59, 130, 246, 0.2) !important;
  }
  
  [data-theme="light"] .project-filter-btn.active:hover {
    background-color: #3b82f6 !important;
  }
</style>